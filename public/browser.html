<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Navegador Zumbi - Reconhecimento de Voz</title>
</head>
<body>
  <script>
    (() => {
      let recognition;

      function log(msg) {
        console.log(`[üéôÔ∏è Reconhecimento] ${msg}`);
      }

      // Verifica√ß√£o de suporte
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

      if (!SpeechRecognition) {
        log("‚ùå API Web Speech n√£o √© suportada neste navegador.");
        return;
      }

      // Inicializa reconhecimento
      window.startRecognition = () => {
        try {
          recognition = new SpeechRecognition();
          recognition.lang = 'pt-BR';
          recognition.continuous = true;
          recognition.interimResults = false;

          recognition.onstart = () => log("üî¥ Reconhecimento de voz iniciado.");
          recognition.onend = () => log("üõë Reconhecimento de voz finalizado.");
          recognition.onerror = (event) => log(`‚ùó Erro: ${event.error}`);

          recognition.onresult = (event) => {
            const transcript = Array.from(event.results)
              .map(result => result[0].transcript)
              .join(' ')
              .trim();

            if (transcript) {
              log(`‚úÖ Texto reconhecido: "${transcript}"`);
              if (typeof window.onTranscription === 'function') {
                window.onTranscription(transcript);
              } else {
                log("‚ö†Ô∏è Fun√ß√£o window.onTranscription n√£o est√° definida.");
              }
            }
          };

          recognition.start();
        } catch (err) {
          log(`üö® Erro ao iniciar reconhecimento: ${err.message}`);
        }
      };

      window.stopRecognition = () => {
        if (recognition) {
          recognition.stop();
          log("‚èπÔ∏è Reconhecimento de voz parado manualmente.");
        }
      };
    })();
  </script>
</body>
</html>
